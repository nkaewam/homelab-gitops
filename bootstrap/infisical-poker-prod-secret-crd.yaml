apiVersion: secrets.infisical.com/v1alpha1
kind: InfisicalSecret
metadata:
  name: infisical-poker-production
  namespace: infisical
spec:
  hostAPI: https://infisical.nkaewam.local/api
  resyncInterval: 10
  tls:
    caRef:
      secretName: homelab-root-ca-secret
      secretNamespace: cert-manager
      key: ca.crt
  authentication:
    kubernetesAuth:
      identityId: 06fce5cc-a6de-4c37-8ce3-ac28cbcf6b50
      autoCreateServiceAccountToken: true
      serviceAccountRef:
        name: infisical-service-account
        namespace: infisical
  
      secretsScope:
        projectId: fa7eb975-c686-4417-9615-4732f718f357
        envSlug: prod
        secretsPath: /


  managedKubeSecretReferences:
    - secretName: poker-production-secrets
      secretNamespace: infisical
      creationPolicy: "Orphan"
      template:
        includeAllSecrets: true
        data:
          NEW_KEY_NAME: "{{ .KEY.SecretPath }} {{ .KEY.Value }}"
          KEY_WITH_BINARY_VALUE: "{{ .KEY.SecretPath }} {{ .KEY.Value }}"